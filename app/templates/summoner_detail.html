{% extends "bootstrap/base.html" %} {% block title %}{{summoner.name}}{% endblock %} {% block content %}
<div class="container">
    <h2>{{summoner.name}}</h2>
    <section>
        <a href="/put_summoner_detail/{{summoner.account_id}}" class="btn btn-primary">更新</a>
        <a href="/get_all_game_match/{{summoner.account_id}}" class="btn btn-primary">對戰紀錄</a>
        <a href="/post_recent_game_match/{{summoner.account_id}}" class="btn btn-primary">更新對戰紀錄</a>
    </section>
    <br/>
    <section>
        <form class="form-inline" action="/get_statistics_champion_use/{{summoner.account_id}}">
            <div class="form-group">
                <label for="lane">Lane</label>
                <input name="lane" type="text" class="form-control" id="lane" placeholder="BOTTOM">
            </div>
            <button class="btn btn-primary" type="submiit">submit</button>
        </form>
    </section>
    <section>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#champion_select">champion</button>

        <div class="modal fade" id="champion_select" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <label for="championName">champion Name:</label>
                        <input type="text" class="form-control" id="championNameInput" placeholder="Annie">
                    </div>
                    <div class="modal-body" id="imgContainer">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

{% endblock %} {% block scripts %} {{super()}}
<script>
    $(document).ready(function () {

        document.getElementById('championNameInput').addEventListener("input", function () {
            $('.championImgs').each(function () {
                $(this).removeClass('hidden');
            });
            var filterStr = this.value.toLowerCase();
            if (filterStr) {
                $('.championImgs').each(function () {
                    var championName = $(this).attr('data-championName').toLowerCase();
                    if (!championName.startsWith(filterStr)) {
                        $(this).addClass('hidden');
                    }
                });
            }
        });

        $('#champion_select').on('show.bs.modal', function () {
            $('#championNameInput').val('');

            if ($('#imgContainer').children().length === 0) {


                var xhr = new XMLHttpRequest();
                xhr.open("POST", "/get_all_champion_img", true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(JSON.stringify({

                }));

                xhr.onreadystatechange = function () {
                    if (this.readyState != 4) return;

                    if (this.status == 200) {
                        var championImgs = JSON.parse(this.responseText);
                        Object.keys(championImgs).forEach(function (key) {
                            var imgUrl = championImgs[key];
                            var tempLenth = "champion/".length;
                            var championName = imgUrl.substr(imgUrl.indexOf("champion/") + tempLenth, imgUrl.lastIndexOf(".png") - imgUrl.indexOf("champion/") - tempLenth);
                            var imgElement = '<img src="' + imgUrl + '"  class="img-thumbnail championImgs" data-championId="' + key + '" data-championName = "' + championName + '">';
                            $('#imgContainer').append(imgElement);
                        })
                    }
                };
            }
        })
    });
</script> {% endblock %}